# cc-spec v1.2 - 背景与目标

## 1. 版本定位

**v1.2 版本主题**: 完善补全 & 工具扩展

v1.2 是 v1.1 的稳定化和扩展版本，主要目标：
1. **同步文档状态** - 修复 v1.1 任务文档与代码实现不同步的问题
2. **补全设计缺失** - 完善 v1.1 设计中未实现的功能
3. **扩展工具支持** - 增加更多 AI 工具的命令生成器
4. **架构优化** - 可选的模板系统升级

## 2. 背景分析

### 2.1 v1.1 实现现状

通过代码审计发现，v1.1 的核心功能已经实现，但存在以下问题：

| 类别 | 问题描述 | 严重程度 |
|------|----------|----------|
| 文档同步 | 任务拆分文档全部显示 🟦 空闲，实际大部分已完成 | 高 |
| 功能缺失 | task_parser 不支持 Profile 字段解析 | 中 |
| 功能缺失 | Config 缺少 agents 多工具配置字段 | 中 |
| 功能简化 | update --templates 只检查不更新 | 低 |
| 工具覆盖 | 命令生成器只有 9/17+ 个工具 | 中 |
| 架构差异 | 使用内联字符串而非 .j2 模板 | 低 |

### 2.2 v1.1 已实现功能确认

| 功能 | 模块 | 状态 |
|------|------|------|
| ID 管理系统 | `core/id_manager.py` | ✅ 完整 |
| list 命令 | `commands/list.py` | ✅ 完整 |
| goto 命令 | `commands/goto.py` | ✅ 完整 |
| update 命令 | `commands/update.py` | ⚠️ 部分 |
| specify 支持 ID | `commands/specify.py` | ✅ 完整 |
| clarify 支持 ID | `commands/clarify.py` | ✅ 完整 |
| plan 支持 ID | `commands/plan.py` | ✅ 完整 |
| apply 支持 ID | `commands/apply.py` | ✅ 完整 |
| checklist 支持 ID | `commands/checklist.py` | ✅ 完整 |
| archive 支持 ID | `commands/archive.py` | ✅ 完整 |
| SubAgent Profile | `core/config.py` | ✅ 完整 |
| 命令生成器 | `core/command_generator.py` | ⚠️ 9/17 |
| v1.1 集成测试 | `tests/integration/test_v11_workflow.py` | ✅ 存在 |

## 3. v1.2 目标

### 3.1 核心目标

1. **P0 - 文档同步**: 更新 v1.1 任务状态，确保文档与代码一致
2. **P0 - Profile 解析**: task_parser 支持 `**Profile**: quick` 字段
3. **P1 - agents 配置**: Config 支持多工具配置 `agents.enabled[]`
4. **P1 - 工具扩展**: 补全至 17+ AI 工具命令生成器

### 3.2 增强目标

5. **P2 - 模板更新**: update --templates 真实从远程获取
6. **P2 - goto 执行**: 选择后自动执行命令（可选）
7. **P3 - .j2 模板**: 迁移到 Jinja2 模板系统（可选）

### 3.3 质量目标

- 测试覆盖率 >= 80%
- 所有新功能有对应单元测试
- 通过 mypy 类型检查
- 通过 ruff 代码规范检查

## 4. 非目标

以下内容不在 v1.2 范围内：

- ❌ 新增命令（保持 7 步工作流）
- ❌ 重构核心架构
- ❌ 更换 CLI 框架
- ❌ 添加 GUI 界面

## 5. 上线标准

### 5.1 功能验收

- [ ] v1.1 任务文档状态全部更新为实际状态
- [ ] task_parser 能正确解析 Profile 字段
- [ ] Config 支持 agents.enabled 列表配置
- [ ] 17+ AI 工具都有对应命令生成器
- [ ] apply 命令能根据 Profile 选择执行参数

### 5.2 质量验收

- [ ] 所有现有测试通过
- [ ] 新增功能测试覆盖
- [ ] mypy 无错误
- [ ] ruff 无警告

### 5.3 文档验收

- [ ] v1.2 设计文档完整
- [ ] README 更新版本信息
- [ ] CHANGELOG 记录变更

## 6. 时间线（仅供参考）

| 阶段 | 任务 |
|------|------|
| Wave 0 | 文档同步 + 基础设施 |
| Wave 1 | Profile 解析 + agents 配置 |
| Wave 2 | 工具生成器扩展 |
| Wave 3 | 增强功能 + 测试完善 |
| Wave 4 | 集成测试 + 文档更新 |
