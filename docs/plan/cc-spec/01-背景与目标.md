# 01 - 背景与目标

## 背景

### 业务目的

当前 AI 辅助开发工具（Claude Code、Cursor、Gemini、Qwen 等）各自独立运行，缺乏统一的规范驱动开发工作流。现有方案存在以下问题：

1. **auto-dev.md 的局限**
   - Token 消耗高（每个实例重复读取上下文）
   - 依赖外部协调（Git 锁机制复杂）
   - 未利用 Claude Code 的 SubAgent 并发能力

2. **OpenSpec 的复杂度**
   - 功能完整但过于复杂
   - 初始化流程繁琐
   - 不支持多种 AI 工具的规划阶段

3. **Spec-Kit 的不足**
   - 需要创建完整项目结构
   - 执行阶段缺乏并发能力
   - 无归档追踪机制

### 解决方案

整合 OpenSpec、Spec-Kit 和 auto-dev 的精华，创建 **cc-spec**：

| 来源 | 取用的精华 |
|------|-----------|
| **OpenSpec** | 智能代码分析、Delta 变更追踪、归档规范、多 AI 工具配置 |
| **Spec-Kit** | CLI 技术栈（uv + typer + rich）、优秀模板、clarify 澄清流程、打分机制 |
| **auto-dev** | SubAgent 并发执行、Git 锁协调、Task 规划格式 |

## 目标

### 上线标准

- [ ] CLI 工具 `cc-spec` 可通过 `uvx --from git+https://github.com/Waasaabii/cc-spec.git cc-spec` 或 `uv tool install cc-spec --from git+...` 安装
- [ ] 支持 7 步标准工作流：init → specify → clarify → plan → apply → checklist → archive
- [ ] 支持超简单模式：`cc-spec quick-delta` 一步生成变更记录
- [ ] apply 阶段支持最多 10 个 SubAgent 并发执行
- [ ] checklist 阶段支持打分机制，不通过自动打回 apply
- [ ] 归档阶段遵循 OpenSpec 规范，Delta 合并到主 specs
- [ ] init 时为选中的 AI 工具生成对应的命令文件，支持在各工具输入框内调用

### 核心原则

```yaml
工具隔离:
  - 每个 AI 工具内保持上下文连续
  - 切换工具时文件是唯一传递媒介
  - 不做跨工具上下文同步

步骤拆分:
  - 宁可多一步，也不要一步做太多
  - 每步产出完整文件，防止上下文压缩丢内容
  - 规划要拆（specify/clarify/plan）、归档也要拆（checklist/archive）

文件驱动:
  - plan 阶段产出 tasks.md
  - apply 阶段读取 tasks.md 分配任务
  - 文件格式决定执行逻辑
```

### 成功指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| Token 节省 | ≥40% | 相比多实例模式，SubAgent 共享上下文 |
| 并发能力 | 10 个 SubAgent | 经测试验证可稳定运行 |
| 工具支持 | 17+ | 继承 Spec-Kit 的 AGENT_CONFIG |
| 命令数量 | 10 个 | init/specify/clarify/plan/apply/checklist/archive/quick-delta/clarify list/clarify {ID} |

## 约束条件

- CLI 使用 Python 3.11+，基于 uv 管理
- 依赖：typer、rich、httpx、readchar
- 不创建复杂项目结构，只下载模板到 `.cc-spec/` 目录
- 执行阶段（apply）仅支持 Claude Code
- 规划阶段支持任意 AI 工具
