# 01 - 背景与目标

## 背景

### v1.0 完成情况

cc-spec v1.0 已实现核心工作流：

| 命令 | 状态 | 说明 |
|------|------|------|
| `init` | ✅ 完成 | 初始化项目，下载模板 |
| `specify` | ✅ 完成 | 创建变更规格 |
| `clarify` | ✅ 完成 | 澄清需求/返工任务 |
| `plan` | ✅ 完成 | 生成执行计划 |
| `apply` | 🟦 开发中 | SubAgent 并发执行 |
| `checklist` | 🟦 开发中 | 验收打分 |
| `archive` | 🟦 开发中 | 归档变更 |
| `quick-delta` | 🟦 开发中 | 超简单模式 |

### 用户痛点

在 v1.0 使用过程中发现以下问题：

1. **缺乏统一列表视图**
   - 无法快速查看所有变更的状态
   - 无法列出任务、规格、归档记录
   - 需要手动进入目录查看文件

2. **回溯操作繁琐**
   - 每个命令都需要手动指定变更名称
   - 无法通过 ID 快速定位
   - 切换变更时需要记住完整名称

3. **配置更新不便**
   - 新增 AI 工具需要重新 init
   - 斜杠命令模板无法单独更新
   - Subagent 配置分散在各处

4. **Subagent 配置重复**
   - 每个任务需要单独配置 model/timeout
   - 无法复用公共配置
   - 难以统一管理扩展上下文设置

### 解决方案

新增三个命令和配套机制：

| 功能 | 解决的问题 |
|------|-----------|
| `cc-spec list` | 统一列表视图，快速查看状态 |
| `cc-spec goto {ID}` | ID 回溯，智能跳转到对应阶段 |
| `cc-spec update` | 配置热更新，新增 AI 工具、更新模板 |
| ID 管理机制 | 所有命令支持 ID 参数，便于回溯 |
| Subagent 公共配置 | common/profiles 模板继承 |

## 目标

### 上线标准

- [ ] `cc-spec list` 可列出 changes/tasks/specs/archive
- [ ] `cc-spec goto {ID}` 可智能跳转到指定变更
- [ ] `cc-spec update` 可更新斜杠命令和配置
- [ ] 所有现有命令支持 ID 参数回溯
- [ ] Subagent 公共配置支持 common/profiles 继承
- [ ] 为 17+ AI 工具生成 `/speckit.list`、`/speckit.goto`、`/speckit.update` 斜杠命令

### 核心原则

```yaml
ID 一致性:
  - 变更 ID 格式: C-{序号} (如 C-001)
  - 任务 ID 格式: {变更ID}:{任务号} (如 C-001:02-MODEL)
  - ID 在列表和回溯中保持一致

配置分层:
  - 公共配置 (common) 被所有 Subagent 继承
  - 配置模板 (profiles) 可按任务类型选用
  - 任务级配置可覆盖公共配置

命令兼容:
  - 新命令不破坏现有工作流
  - 现有命令增加 ID 参数为可选
  - 保持向后兼容
```

### 成功指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 命令数量 | 11 个 | 新增 list/goto/update |
| ID 回溯 | 100% | 所有命令支持 ID 参数 |
| AI 工具支持 | 17+ | 继承 v1.0，新增斜杠命令 |
| 配置复用 | ≥80% | Subagent 配置可通过 profiles 复用 |

## 约束条件

- 基于 v1.0 代码库增量开发
- 不修改现有文件结构（.cc-spec/ 目录）
- 保持 Python 3.11+ 兼容
- 斜杠命令格式与 Spec-Kit 保持一致（`/speckit.xxx`）

## 与 v1.0 的关系

```
cc-spec v1.0
├── init / specify / clarify / plan    ← 已完成
├── apply / checklist / archive         ← 开发中
└── quick-delta                          ← 开发中

cc-spec v1.1 (本次)
├── list / goto / update                ← 新增命令
├── ID 管理机制                          ← 新增模块
├── Subagent 公共配置                    ← 新增配置
├── 现有命令 ID 支持                     ← 增强
└── 斜杠命令模板更新                     ← 增强
```

**注意**: v1.1 可与 v1.0 剩余任务并行开发，互不依赖。

---

*基于 v1.0 使用反馈和需求分析编写*
